<!DOCTYPE html>
<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script>
          async function routine_tasks(){

            if ($('#topic').html()=="No Topic Has Been Set"){

              getcurrenttopic();

            }
            if (($('#speaking_mode').html()=="Mod")&&($('#current_mod').html()=='No Moderated Caucus in Progress')){

              getcurrentmod();

            }
            else if($('#speaking_mode').html()!="Mod"){

              $('#current_mod').html('No Moderated Caucus in Progress');

            }

          }
          async function getattendance() {
            let x = await fetch("/dashboards/getcountrylist");
            let y = await x.text();
            $('#att').html(y);
          }
          async function getcurrentmod(){
            let x = await fetch("/dashboards/get_current_mod");
            let y = await x.text();
            $('#current_mod').html(y);
          }
          async function getspeakingmode(){
            let x = await fetch("/dashboards/get_speaking_mode");
            let y = await x.text();
            $('#speaking_mode').html(y);
          }
          async function getcurrenttopic(){
            let x = await fetch("/dashboards/get_current_topic");
            let y = await x.text();
            $('#topic').html(y);
          }
          setInterval(routine_tasks,1000)
          setInterval(getattendance,1000);
          setInterval(getspeakingmode,15000);
        </script>
        <style>
            #leftbox {
                float:left;
                background:white;
                width:25%;
                height:280px;
            }
            #middlebox{
                float:left;
                background:white;
                width:50%;
                height:280px;
            }
            #rightbox{
                float:right;
                background:white;
                width:25%;
                height:280px;
            }
            h1{
                color:black;
                text-align:center;
            }
        </style>
    </head>

    <body onbeforeunload="fetch('logout')">
        <div id = "boxes">
            <h1>{{committee}}</h1>

            <div id = "leftbox">
                <h2>BLANK</h2>

            </div>

            <div id = "middlebox">

                <h2>Topic: <div id="topic">No Topic Has Been Set</div></h2>
                <h3>Speaking Mode: <div id="speaking_mode">Idle</div></h3>
                <h4>Current Mod: <div id="current_mod">No Moderated Caucus in Progress</div></h4>

            </div>

            <div id = "rightbox">
                <h2>Delegates Present:</h2>
                <div id="att">No one present.</div>
                <input type="button" class="btn" value="Raise Placard" onclick="fetch('raise_placard')">
                <input type="button" class="btn" value="Lower Placard" onclick="fetch('lower_placard')"><br>
                <input type="button" class="btn" value="Log Out" onclick="window.location.href='logout'"><br>
            </div>
        </div>
    </body>
</html>
